# Chpater 08 ì˜ì¡´ì„± ê´€ë¦¬í•˜ê¸°

## ì˜ì¡´ì„± ì´í•´í•˜ê¸°

### 1. ì„œë¡ 

ì˜ ì„¤ê³„ëœ ê°ì²´ì§€í–¥ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì‘ê³  ì‘ì§‘ë„ ë†’ì€ ê°ì²´ë“¤ë¡œ êµ¬ì„±ëœë‹¤.

ì—¬ê¸°ì—ì„œ ì‘ê³  ì‘ì§‘ë„ ë†’ì€ ê°ì²´ë“¤ì´ë€ ì´ˆì ì´ ëª…í™•í•˜ê³  í•œ ê°€ì§€ ì¼ë§Œ ì˜í•˜ëŠ” ê°ì²´ë¥¼ ì˜ë¯¸í•œë‹¤.

ì´ëŸ° ê°ì²´ë“¤ì€ ë‹¨ë…ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì´ ê±°ì˜ ì—†ê¸° ë‹¤ë¥¸ ê°ì²´ë“¤ê³¼ í˜‘ë ¥ì„ í•œë‹¤.

í˜‘ë ¥ì€ ê°ì²´ê°€ ë‹¤ë¥¸ ê°ì²´ì— ëŒ€í•´ ì•Œê²ƒì„ ê°•ìš”í•œë‹¤. ë‹¤ë¥¸ ê°ì²´ì™€ í˜‘ë ¥ í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ë¥¸ ê°ì²´ë“¤ë„ ì´ëŸ¬í•œ í˜‘ë ¥í•˜ëŠ” ê°ì²´ê°€ ì¡´ì¬í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  ê°ì²´ê°€ ìˆ˜ì‹ í•  ìˆ˜ ìˆëŠ” ë©”ì‹œì§€ë„ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤. ì´ëŸ° ì§€ì‹ì´ ê°ì²´ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì„ ë‚³ëŠ”ë‹¤.

í˜‘ë ¥ì„ ìœ„í•´ì„œëŠ” ì˜ì¡´ì„±ì´ í•„ìš”í•˜ì§€ë§Œ ê³¼ë„í•œ ì˜ì¡´ì„±ì€ ìˆ˜ì •í•˜ê¸° ì–´ë µê²Œ í•œë‹¤.

**ê°ì²´ì§€í–¥ ì„¤ê³„**ì˜ í•µì‹¬ì€ í˜‘ë ¥ì„ ìœ„í•´ í•„ìš”í•œ ì˜ì¡´ì„±ì€ ìœ ì§€í•˜ë©´ì„œ ë³€ê²½ì— ë°©í•´í•˜ëŠ” ì˜ì¡´ì„±ì„ ì œê±°í•˜ëŠ”ë° ìˆë‹¤. ê°ì²´ê°€ ë³€í™”ë¥¼ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆê²Œ ì˜ì¡´ì„±ì„ ì •ë¦¬í•˜ëŠ” ê¸°ìˆ ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

### ë³€ê²½ê³¼ ì˜ì¡´ì„±

ê°ì²´ê°€ í˜‘ë ¥í•˜ê¸° ìœ„í•´ ë‹¤ë¥¸ ê°ì²´ë¥¼ í•„ìš”ë¡œ í• ë•Œ ë‘ ê°ì²´ ì‚¬ì´ì— ì˜ì¡´ì„±ì´ ì¡´ì¬í•˜ê²Œ ëœë‹¤.

ì˜ì¡´ì„±ì€ ì‹¤í–‰ì‹œì ê³¼ êµ¬í˜„ì‹œì ì—ì„œ ë‘ê°€ì§€ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤.

<aside>
ğŸ”– **ì‹¤í–‰ì‹œì **
ì˜ì¡´í•˜ëŠ” ê°ì²´ê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´ì„œëŠ” ì‹¤í–‰ ì‹œì— ì˜ì¡´ ëŒ€ìƒ ê°ì²´ê°€ ë°˜ë“œì‹œ ì¡´ì¬í•´ì•¼ í•œë‹¤.

</aside>

<aside>
ğŸ”– **êµ¬í˜„ì‹œì **
ì˜ì¡´ ëŒ€ìƒ ê°ì²´ê°€ ë³€ê²½ë  ê²½ìš° ì˜ì¡´í•˜ëŠ” ê°ì²´ë„ í•¨ê»˜ ë³€ê²½ëœë‹¤.

</aside>

ë‘ ì˜ë¯¸ë¥¼ ì½”ë“œë¡œ í™•ì¸í•œë‹¤

```java
public class PeriodCondition implements DiscountCondition{
	private DayOfWeek dayOfWeek;
	private LocalTime startTime;
	private LocalTime endTime;

	...

	public boolean isSatisfiedBy(Screening screening){
		return screening.getStartTime().getDayOfWeek().equals(dayOfWeek) &&
			startTime.compareTo(screening.getStartTime().toLocalTime()) <= 0 &&
			endTime.compareTo(screening.getStartTime().toLocalTime()) >= 0;
	}
}
```

PeriodConditionì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ê¸° ìœ„í•´ì„œëŠ” Screeningì´ ì¡´ì¬í•´ì•¼í•œë‹¤. ë§Œì•½ Screeningì´ ì¡´ì¬ í•˜ì§€ ì•Šê±°ë‚˜ getStartTimeì„ ì´í•´í•˜ì§€ ëª»í•œë‹¤ë©´ ì •ì‚­ì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•Šì„ê²ƒì´ë‹¤.

![PeriodConditionì´ ê°€ì§€ëŠ” ì˜ì¡´ì„±](Chpater%2008%20%E1%84%8B%E1%85%B4%E1%84%8C%E1%85%A9%E1%86%AB%E1%84%89%E1%85%A5%E1%86%BC%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%84%80%E1%85%B5%2041888d52622f493398bb3a16efee6778/Untitled.png)

PeriodConditionì´ ê°€ì§€ëŠ” ì˜ì¡´ì„±

ì—¬ê¸°ì—ì„œ DayOfWeekí´ë˜ìŠ¤ì˜ ì´ë¦„ì„ ë°”ê¿”ì•¼ í•œë‹¤ê³  ê°€ì •í•˜ë©´ PeriodCondition í´ë˜ìŠ¤ì˜ ì •ì˜ëœ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì˜ íƒ€ì… ì„ ì–¸ë„ í•¨ê»˜ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

> **UMLê³¼ ì˜ì¡´ì„±**
UMLê³¼ ì˜ì¡´ì„± ê´€ê³„ëŠ” ì¡°ê¸ˆ ë‹¤ë¥´ë‹¤ UMLì€ ë‹¤ì–‘í•œ ê´€ê³„ì˜ **ì˜ì¡´ê´€ê³„**ë¥¼ ì •ì˜í•œë‹¤. í•˜ì§€ë§Œ ì˜ì¡´ì„±ì€ ë‘ ìš”ì†Œ ì‚¬ì´ì— ë³€ê²½ì— ì˜í•´ ì˜í–¥ì„ ì£¼ê³ ë°›ëŠ” í˜ì˜ ì—­í•™ê´€ê³„ê°€ ì¡´ì¬í•œë‹¤.
> 

### ì˜ì¡´ì„± ì „ì´

ì˜ì¡´ì„±ì€ ì „ì´ ë  ìˆ˜ ìˆë‹¤. PeriodConditionì´ Screeningì„ ì˜ì¡´í•œë‹¤ë©´ Screeningì´ ì˜ì¡´í•˜ëŠ” ëŒ€ìƒë„ ìë™ì ìœ¼ë¡œ ì˜ì¡´ì„ í•œë‹¤.

ì´ë ‡ê²Œ ì „ì´ê°€ ë ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì˜ì¡´ì„± ì¢…ë¥˜ë¥¼ ë‘ê°€ì§€ë¡œ ë‚˜ëˆˆë‹¤.

<aside>
ğŸ”– ì§ì ‘ ì˜ì¡´ì„± : í•œ ìš”ì†Œê°€ ë‹¤ë¥¸ ìš”ì†Œì— ì§ì ‘ ì˜ì¡´í•˜ëŠ” ê²½ìš°
ê°„ì ‘ ì˜ì¡´ì„± : ì§ì ‘ì ì¸ ê´€ê³„ëŠ” ì¡´ì¬í•˜ì§€ ì•Šì§€ë§Œ ì˜ì¡´ì„± ì „ì´ì— ì˜í•´ ì˜í–¥ì´ ì „íŒŒë˜ëŠ” ê²½ìš°

</aside>

### ëŸ°íƒ€ì„ ì˜ì¡´ì„±ê³¼ ì»´íŒŒì¼íƒ€ì„ ì˜ì¡´ì„±

<aside>
ğŸ”– ëŸ°íƒ€ì„ ì˜ì¡´ì„± : ê°ì²´ ì‚¬ì´ì˜ ì˜ì¡´ì„±
ì»´íŒŒì¼íƒ€ì„ ì˜ì¡´ì„± : í´ë˜ìŠ¤ ì‚¬ì´ì˜ ì˜ì¡´ì„±

</aside>

```java
public class Movie{
	private DiscountPolicy discountPolicy
	public Movie(String title, Duration runningTime, Money fee, DiscountPolicy discountPolicy){
		this.discountPolicy = discountPolicy;
	}
	public Money calculateMovieFee(Screening screening){
		return fee.minus(discountPolicy.calculateDiscountAmount(screening));
	}
}
```

![Untitled](Chpater%2008%20%E1%84%8B%E1%85%B4%E1%84%8C%E1%85%A9%E1%86%AB%E1%84%89%E1%85%A5%E1%86%BC%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%84%80%E1%85%B5%2041888d52622f493398bb3a16efee6778/Untitled%201.png)

ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê²ƒì€ Movieê°€ AmountDiscountPolicyì™€ PercentDIscountPolicyì— ì˜ì¡´ë„ê°€ ì—†ë‹¤ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ëŸ°íƒ€ì„ ì˜ì¡´ì„±ì„ ì‚´í´ë³´ë©´ ì „í˜€ ë‹¬ë¼ì§„ë‹¤.

![Untitled](Chpater%2008%20%E1%84%8B%E1%85%B4%E1%84%8C%E1%85%A9%E1%86%AB%E1%84%89%E1%85%A5%E1%86%BC%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%84%80%E1%85%B5%2041888d52622f493398bb3a16efee6778/Untitled%202.png)

Movie í´ë˜ìŠ¤ëŠ” AmountDiscountPolicyì™€ PercentDiscountPolicyë¥¼ ì•Œì§€ ëª»í•˜ì§€ë§Œ ì‹¤í–‰ì‹œì ì— MovieëŠ” AmountDiscountPolicyì™€ PercentDiscountPolicyì™€ í˜‘ë ¥ í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

í•˜ì§€ë§Œ í´ë˜ìŠ¤ì— ëŒ€í•´ì„œë§Œ ì˜ì¡´í•˜ê²Œ ëœë‹¤ë©´, Movieê°€ AmountDiscountPolicyì™€ í˜‘ë ¥í•œë‹¤ë©´ PercentDiscountPolicyì™€ëŠ” í˜‘ë ¥ í•  ìˆ˜ ì—†ê²Œ ë ê²ƒì´ë‹¤.

ê·¸ë˜ì„œ AmountDiscountPolicyì™€ PercentDiscountPolicy ë‘˜ë‹¤ í˜‘ë ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” ëŸ°íƒ€ì„ì˜ì¡´ì„±ìœ¼ë¡œ ëŒ€ì²´í•´ì•¼ í•œë‹¤. 

ëŸ°íƒ€ì„ ì˜ì¡´ì„±ì˜ ì¥ì ì€ ì—¬ëŸ¬ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì™€ í˜‘ë ¥í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

ìœ ì—°í•˜ê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ê³„ë¥¼ ì°½ì¡°í•˜ê¸° ìœ„í•´ì„œëŠ” ë™ì¼í•œ ì†ŒìŠ¤ì½”ë“œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ë‹¤ì–‘í•œ ì‹¤í–‰êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ì•¼í•œë‹¤.

ê²°ë¡ ì€ ì»´íŒŒì¼ êµ¬ì¡°ì™€ ëŸ°íƒ€ì„ êµ¬ì¡° ì‚¬ì´ì˜ ê±°ë¦¬ê°€ ë©€ë©´ ë©€ìˆ˜ë¡ ì„¤ê³„ê°€ ìœ ì—°í•´ì§€ê³  ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì§„ë‹¤.

### **ì»¨í…ìŠ¤íŠ¸ ë…ë¦½ì„±**

í´ë˜ìŠ¤ê°€ íŠ¹ì •í•œ ë¬¸ë§¥ì— ê°•í•˜ê²Œ ê²°í•©ë ìˆ˜ë¡ ë‹¤ë¥¸ ë¬¸ë§¥ì—ì„œ ì‚¬ìš©í•˜ê¸°ëŠ” ë” ì–´ë ¤ì›Œì§„ë‹¤. í´ë˜ìŠ¤ê°€ ì‚¬ìš©ë  íŠ¹ì •í•œ ë¬¸ë§¥ì— ëŒ€í•´ ìµœì†Œí•œì˜ ê°€ì •ë§Œìœ¼ë¡œ ì´ë¤„ì ¸ ìˆë‹¤ë©´ ë‹¤ë¥¸ ë¬¸ë§¥ì—ì„œ ì¬ì‚¬ìš© í•˜ê¸°ê°€ ë” ìˆ˜ì›”í•´ì§„ë‹¤. ì´ë¥¼ **ì»¨í…ìŠ¤íŠ¸ ë…ë¦½ì„±**ì´ë¼ í•œë‹¤.

ì„¤ê³„ê°€ ìœ ì—°í•´ì§€ê¸° ìœ„í•´ì„œëŠ” ê°€ëŠ¥í•œ í•œ ìì‹ ì´ ì‹¤í–‰ë  ì»¨í…ìŠ¤íŠ¸ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ ìµœëŒ€í•œ ì ê²Œ ì•Œì•„ì•¼ í•œë‹¤.

> ë§ˆì§€ë§‰ ì—°ê²°ê³ ë¦¬ì¸ í´ë˜ìŠ¤ê°€ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì— ë…ë¦½ì ì¸ë°ë„ ì–´ë–»ê²Œ ëŸ°íƒ€ì„ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì— ëŒ€í•´ ì ì ˆí•œ ê°ì²´ë“¤ê³¼ í˜‘ë ¥í•  ìˆ˜ ìˆì„ê¹Œ
> 

### ì˜ì¡´ì„±í•´ê²°í•˜ê¸°

<aside>
ğŸ”– 1. ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ì‹œì ì— ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ì„± í•´ê²°
2. ê°ì²´ ìƒì„± í›„ setter ë©”ì„œë“œë¥¼ í†µí•´ ì˜ì¡´ì„± í•´ê²°
3. ë©”ì„œë“œ ì‹¤í–‰ ì‹œ ì¸ìë¥¼ ì´ìš©í•´ ì˜ì¡´ì„± í•´ê²°

</aside>

```java
// 1. ë©”ì„œë“œ ì‹¤í–‰ ì‹œ ì¸ìë¥¼ ì´ìš©í•´ ì˜ì¡´ì„± í•´ê²°
Movie avatar = new Movie("ì•„ë°”íƒ€", 
		Duration.ofMinutes(120),
		Money.wons(10000),
		new AmountDiscountPolicy(...));

Movie starWars = new Movie("ìŠ¤íƒ€ì›Œì¦ˆ",
		Duration.ofMinutes(180),
		Money.wons(11000),
		new PercentDiscountPolicy(...));

public class Movie{
	public Movie(String title, Duration runningTime, Money fee, DiscountPolicy discountPolicy){
		...
		this.discountPolicy = discountPolicy;
	}
}
```

```java
// 2. ê°ì²´ ìƒì„± í›„ setter ë©”ì„œë“œë¥¼ í†µí•´ ì˜ì¡´ì„± í•´ê²°
Movie avatar = new Movie(...);
avatar.setDiscountPolicy(new AmountDiscountPolicy(...));

public class Movie{
	public void setDiscountPolicy(DiscountPolicy discountPolicy){
		this.discountPolicy = discountPolicy;
	}
}

avatar.calcurateFee(...); // ì—ëŸ¬ ë°œìƒ
```

ë” ì¢‹ì€ ë°©ë²•ì€ setter ë°©ì‹ê³¼ ìƒì„±ì ë°©ì‹ì„ í•©ì¹˜ëŠ” ê²ƒì´ë‹¤.

```java
// 1 + 2
Movie avatar = new Movie(..., new PercentDiscountPolicy(...)));
...
avatar.setDiscountPolicy(new AmountDiscountPolicy(...));
```

```java
// 3. ë©”ì„œë“œ ì‹¤í–‰ ì‹œ ì¸ìë¥¼ ì´ìš©í•´ ì˜ì¡´ì„± í•´ê²°
public class Movie{
	publlic Money calculateMovieFee(Screening screening, DsicountPolicy discountPolicy){
		return fee.minus(discountPolicy.calculateDiscountAmount(screening));
	}
}
```

ë©”ì„œë“œê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ì˜ì¡´ ëŒ€ìƒì´ ë§¤ë²ˆ ë‹¬ë¼ì ¸ì•¼ í•˜ëŠ” ê²½ìš° ìœ ìš©í•˜ë‹¤.

í•˜ì§€ë§Œ í´ë˜ìŠ¤ ë©”ì„œë“œë¥¼ í˜¸ì¶œ í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì—ëŠ” ë§¤ë²ˆ ë™ì¼í•œ ê°ì²´ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ê³  ìˆë‹¤ë©´ ìƒì„±ìë¥¼ ì´ìš©í•˜ëŠ” ë°©ì‹ì´ë‚˜ setter ë©”ì„œë“œë¥¼ ì´ìš©í•´ ì˜ì¡´ì„±ì„ ì§€ì†ì ìœ¼ë¡œ ìœ ì§€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

## ìœ ì—°í•œ ì„¤ê³„

### ì˜ì¡´ì„±ê³¼ ê²°í•©ë„

ê°ì²´ë“¤ì´ í˜‘ë ¥í•˜ê¸° ìœ„í•´ì„œëŠ” ì„œë¡œì˜ ì¡´ì¬ì™€ ìˆ˜í–‰ ê°€ëŠ¥í•œ ì±…ì„ì„ ì•Œì•„ì•¼ í•˜ê³  ì´ëŸ° ì§€ì‹ë“¤ì€ ê°ì²´ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì„ ë‚³ëŠ”ë‹¤.

ë”°ë¼ì„œ, ëª¨ë“  ì˜ì¡´ì„±ì´ ë‚˜ìœê²ƒì€ ì•„ë‹ˆë‹¤.

ë‹¤ë§Œ, ì˜ì¡´ì„±ì´ ê³¼í•˜ë©´ ë¬¸ì œê°€ ëœë‹¤.

```java
public class Movie {
    private String title;
    private Duration runningTime;
    private Money fee;
    private PercentDiscountPolicy percentDiscountPolicy;

    public Movie(String title, Duration runningTime, Money fee, PercentDiscountPolicy percentDiscountPolicy) {
        this.title = title;
        this.runningTime = runningTime;
        this.fee = fee;
        this.percentDiscountPolicy = percentDiscountPolicy;
    }

    public Money getFee() {
        return fee;
    }

    public Money calculateMovieFee(Screening screening) {
        return fee.minus(percentDiscountPolicy.calculateDiscountAmount(screening));
    }
}
```

ìœ„ ì½”ë“œì—ì„œ Movie - PercentDiscountPolicy ì‚¬ì´ì˜ ì˜ì¡´ì„±ì˜ ì¡´ì¬ëŠ” ë¬¸ì œê°€ ì—†ë‹¤.

í•˜ì§€ë§Œ ì˜ì¡´ì„±ì˜ ì •ë„ì—ëŠ” ë¬¸ì œê°€ ìˆë‹¤.

**ë¬¸ì œ**: Movie ê°€ PercentDiscountPolicy ë¼ëŠ” êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´í•˜ê²Œ ë˜ë©´ì„œ ë‹¤ë¥¸ í• ì¸ ì •ì±…ê³¼ëŠ” í˜‘ë ¥í•  ìˆ˜ ì—†ê²Œ ë§Œë“¤ì–´ë²„ë¦°ë‹¤.

**í•´ê²° ë°©ë²•**: Movieê°€ ì¶”ìƒ í´ë˜ìŠ¤ì¸ DiscountPolicyì™€ í˜‘ë ¥í•˜ê²Œ ë§Œë“¤ë©´ ë‹¤ë¥¸ í• ì¸ ì •ì±…ê³¼ í˜‘ë ¥í•  ìˆ˜ ìˆë‹¤.

ë°”ëŒì§í•œ ì˜ì¡´ì„±ì€ ì¬ì‚¬ìš©ì„±ê³¼ ê´€ë ¨ì´ ìˆë‹¤.

ì–´ë–¤ ì˜ì¡´ì„±ì´ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ í´ë˜ìŠ¤ë¥¼ ì¬ì‚¬ìš© í•  ìˆ˜ ì—†ë„ë¡ í•œë‹¤ë©´, ê·¸ ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ì§€ ëª»í•˜ë‹¤.

ì–´ë–¤ ì˜ì¡´ì„±ì´ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ í´ë˜ìŠ¤ë¥¼ ì¬ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤ë©´, ê·¸ ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ë‹¤.

ì»¨í…ìŠ¤íŠ¸ ë…ë¦½ì ì¸ ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ë‹¤.

íŠ¹ì • ì»¨í…ìŠ¤íŠ¸ì— ê°•í•˜ê²Œ ê²°í•©ëœ ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ì§€ ëª»í•˜ë‹¤.

ëŠìŠ¨í•œ ê²°í•©ë„(loose coupling), ì•½í•œ ê²°í•©ë„(weak coupling)ë¥¼ ê°€ì§€ëŠ” ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ë‹¤.

ê°•í•œ ê²°í•©ë„(tight coupling), ë‹¨ë‹¨í•œ ê²°í•©ë„(strong coupling)ë¥¼ ê°€ì§€ëŠ” ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ì§€ ëª»í•˜ë‹¤.

**ê²°ë¡ **: 

Movie - PercentDiscountPolicy ê°„ì˜ ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ì§€ ëª»í•˜ë‹¤.

Movie - DiscountPolicy ê°„ì˜ ì˜ì¡´ì„±ì€ ë°”ëŒì§í•˜ë‹¤.

### ì§€ì‹ì´ ê²°í•©ì„ ë‚³ëŠ”ë‹¤

í•œ ìš”ì†Œê°€ ìì‹ ì´ ì˜ì¡´í•˜ëŠ” ìš”ì†Œì— ëŒ€í•´ ë§ì´ ì•Œìˆ˜ë¡ ê°•í•˜ê²Œ ê²°í•©ëœë‹¤.

Movie - PercentDiscountPolicy ëŠ” Movieê°€ êµ¬ì²´ì ì¸ í• ì¸ ë°©ë²•ê¹Œì§€ ì•Œê³ ìˆë‹¤.

Movie - DiscountPolicy ëŠ” Movieê°€ í• ì¸ ìš”ê¸ˆì„ ê³„ì‚°í•œë‹¤ëŠ” ê²ƒë§Œ ì•Œê³ ìˆë‹¤.

ë” ë§ì´ ì•Œê³  ìˆì„ ìˆ˜ë¡ ë” ì ì€ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.

ê²°í•©ë„ë¥¼ ëŠìŠ¨í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” ë” ì ê²Œ ì•Œì•„ì•¼ í•œë‹¤.

**ê²°ë¡ **: ê²°í•©ë„ë¥¼ ëŠìŠ¨í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œ ì¶”ìƒí™”ë¥¼ í•´ì•¼ í•œë‹¤.

### ì¶”ìƒí™”ì— ì˜ì¡´í•˜ë¼

ì¶”ìƒí™”: ì–´ë–¤ ì–‘ìƒ, ì„¸ë¶€ì‚¬í•­, êµ¬ì¡°ë¥¼ ì¢€ ë” ëª…í™•í•˜ê²Œ ì´í•´í•˜ê¸° ìœ„í•´ íŠ¹ì • ì ˆì°¨ë‚˜ ë¬¼ì²´ë¥¼ ì˜ë„ì ìœ¼ë¡œ ìƒëµí•˜ê±°ë‚˜ ê°ì¶¤ìœ¼ë¡œì¨ ë³µì¡ë„ë¥¼ ê·¹ë³µí•˜ëŠ” ë°©ë²• 

ì¶”ìƒí™”ì˜ ì •ë„ê°€ ì˜¬ë¼ê°ˆìˆ˜ë¡ ê²°í•©ë„ê°€ ëŠìŠ¨í•´ì§„ë‹¤.

êµ¬ì²´ í´ë˜ìŠ¤ ì˜ì¡´ì„±(concrete class dependency) : ê²°í•©ë„ ê°€ì¥ ê°•í•¨

ì¶”ìƒ í´ë˜ìŠ¤ ì˜ì¡´ì„± (abstract class dependency) : ê²°í•©ë„ ì¤‘ê°„

ì¸í„°í˜ì´ìŠ¤ ì˜ì¡´ì„± (interface dependency) : ê²°í•©ë„ ê°€ì¥ ì•½í•¨

**ê²°ë¡ **: ì¸í„°í˜ì´ìŠ¤ìª½ìœ¼ë¡œ ê°ˆìˆ˜ë¡ í´ë¼ì´ì–¸íŠ¸ê°€ ì•Œì•„ì•¼ í•˜ëŠ” ì§€ì‹ì˜ ì–‘ì´ ì¤„ì–´ë“¤ì–´ì„œ ê²°í•©ë„ê°€ ëŠìŠ¨í•´ì§„ë‹¤.

### ëª…ì‹œì ì¸ ì˜ì¡´ì„±

```java
public class Movie {
    private String title;
    private Duration runningTime;
    private Money fee;
    private DiscountPolicy discountPolicy;

    public Movie(String title, Duration runningTime, Money fee) {
        this.title = title;
        this.runningTime = runningTime;
        this.fee = fee;
        this.discountPolicy = new PercentDiscountPolicy();
    }
}
```

ìœ„ ì½”ë“œëŠ” discountPolicyë¥¼ ì¸í„°í˜ì´ìŠ¤ íƒ€ì…ìœ¼ë¡œ ì •ì˜í–ˆìŒì—ë„ ê²°í•©ë„ê°€ ë†’ë‹¤.

this.discountPolicy = new PercentDiscountPolicy(); 

ì´ë¶€ë¶„ë•Œë¬¸ì—  êµ¬ì²´ í´ë˜ìŠ¤ì¸ PercentDiscountPolicy ì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ë ‡ê²Œ Movie ë‚´ë¶€ì— ìˆëŠ” ì˜ì¡´ì„±ì„ ìˆ¨ê²¨ì§„ ì˜ì¡´ì„±(hidden dependency)ë¼ê³  ë¶€ë¥¸ë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ìƒì„±ì, setter, ë©”ì„œë“œ ì¸ìë¡œ ì˜ì¡´ì„±ì„ ì£¼ì…í•´ì•¼ í•œë‹¤.

ì´ëŸ¬í•œ ë°©ë²•ìœ¼ë¡œ ì˜ì¡´ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ë…¸ì¶œí•˜ëŠ”ê²ƒì„ 
ëª…ì‹œì ì¸ ì˜ì¡´ì„±(explicit dependency)ë¼ê³  ë¶€ë¥¸ë‹¤.

```java
public class Movie {
    private String title;
    private Duration runningTime;
    private Money fee;
    private DiscountPolicy discountPolicy;

		// ìƒì„±ì
    public Movie(String title, Duration runningTime, Money fee, DiscountPolicy discountPolicy) {
        this.title = title;
        this.runningTime = runningTime;
        this.fee = fee;
        this.discountPolicy = discountPolicy;
    }

		// setter
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

		// ë©”ì„œë“œ ì¸ì
		public Money calculateMovieFee(Screening screening, DiscountPolicy discountPolicy) {
        return fee.minus(discountPolicy.calculateDiscountAmount(screening));
    }
}
```

ìœ„ ì½”ë“œì²˜ëŸ¼ ëª…ì‹œì ì¸ ì˜ì¡´ì„±ì„ ì‚¬ìš©í•´ì•¼ ëŸ°íƒ€ì„ ì˜ì¡´ì„±ì„ í†µí•´ ì ì ˆí•œ ì˜ì¡´ì„±ì„ ì„ íƒí•  ìˆ˜ ìˆê²Œ ëœë‹¤.

**ê²°ë¡ **: ì˜ì¡´ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ ë“œëŸ¬ë‚´ì

### new ëŠ” í•´ë¡­ë‹¤

í•´ë¡œìš´ ì´ìœ 

- newë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´í•˜ê²Œ ëœë‹¤.
- newë¡œ ìƒì„±í•˜ë ¤ëŠ” í´ë˜ìŠ¤ì˜ ìƒì„±ìê°€ ì–´ë–¤ ì¸ìê°€ í•„ìš”í•œì§€ ì•Œì•„ì•¼í•œë‹¤.
- ìœ„ ë‘ê°€ì§€ ì´ìœ ë¡œ ê²°í•©ë„ê°€ ë†’ì•„ì§„ë‹¤.

```java
public class Movie {
    private DiscountPolicy discountPolicy;

    public Movie() 
        this.discountPolicy = new AmountDiscountPolicy(
					Money.wons(800),
					new SequenceCondition(1),
					new PeriodCondition(DayOfWeek.MONDAY, LocalTime.of(10,0)
				);
    }
}
```

![Untitled](Chpater%2008%20%E1%84%8B%E1%85%B4%E1%84%8C%E1%85%A9%E1%86%AB%E1%84%89%E1%85%A5%E1%86%BC%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%92%E1%85%A1%E1%84%80%E1%85%B5%2041888d52622f493398bb3a16efee6778/Untitled%203.png)

ìœ„ ì½”ë“œì²˜ëŸ¼ ê²°í•©ë„ê°€ ì˜¬ë¼ê°€ì„œ ë³€ê²½ì— ì·¨ì•½í•´ì§„ë‹¤.

ì´ ë¬¸ì œë¥¼ í”¼í•˜ê¸° ìœ„í•´ ìƒì„±í•˜ëŠ” ì±…ì„ê³¼ ì‚¬ìš©í•˜ëŠ” ì±…ì„ì„ ë¶„ë¦¬í•´ì•¼í•œë‹¤.

```java
public class Movie {
    private DiscountPolicy discountPolicy;

		// ìƒì„±í•˜ëŠ” ì±…ì„ì´ ì‚¬ë¼ì§
    public Movie(DiscountPolicy discountPolicy) 
        this.discountPolicy = discountPolicy
    }

		// ì‚¬ìš©í•˜ëŠ” ì±…ì„ë§Œ ìˆìŒ
		public Money calculateMovieFee(Screening screening) {
        return fee.minus(discountPolicy.calculateDiscountAmount(screening));
    }
}

// ìƒì„±í•˜ëŠ” ì±…ì„
public class Some {

	public void use() {
		Movie movie = new Movie(
			new AmountDiscountPolicy(
					Money.wons(800),
					new SequenceCondition(1),
					new PeriodCondition(DayOfWeek.MONDAY, LocalTime.of(10,0)
				)
			);
	}

}
```

**ê²°ë¡ **: ìƒì„±í•˜ëŠ” ì±…ì„ê³¼ ì‚¬ìš©í•˜ëŠ” ì±…ì„ì„ ë¶„ë¦¬í•˜ì.

### ê°€ë”ì€ ìƒì„±í•´ë„ ë¬´ë°©í•˜ë‹¤

í˜‘ë ¥í•˜ëŠ” ê¸°ë³¸ ê°ì²´ë¥¼ ì„¤ì •í•˜ê³  ì‹¶ìœ¼ë©´ ìƒì„±í•´ë„ ëœë‹¤.

ì½”ë“œì˜ ì¤‘ë³µì´ ì¤„ì–´ë“¤ê²ƒì´ë‹¤.

```java
public class Movie {
    private DiscountPolicy discountPolicy;

		// ì´ë ‡ê²Œ ê¸°ë³¸ ê°ì²´ë¥¼ ìƒì„±í•˜ì
		public Movie() {
        this(new AmountDiscountPolicy());
    }

		// ì´ê±°ë¡œ êµì²´ë„ ê°€ëŠ¥í•˜ë‹¤.
    public Movie(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy
    }
}
```

ìœ„ ì½”ë“œëŠ” ì‚¬ìš©ì„±ì„ ì˜¬ë¦¬ê³  ê²°í•©ë„ë¥¼ ë†’ì¸ë‹¤.

**ê²°ë¡ **: ê²°í•©ë„ê°€ ëª¨ì´ëŠ” ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ë©´ ì‚¬ìš©ì„±ê³¼ ìœ ì—°ì„±ì„ ëª¨ë‘ ì¡ì„ ìˆ˜ ìˆë‹¤. (9ì¥ íŒ©í† ë¦¬)

### í‘œì¤€ í´ë˜ìŠ¤ì— ëŒ€í•œ ì˜ì¡´ì€ í•´ë¡­ì§€ ì•Šë‹¤.

ArrayListê°™ì€ í‘œì¤€ í´ë˜ìŠ¤ëŠ” ë³€ê²½ë  í™•ë¥ ì´ ê±°ì˜ ì—†ì–´ì„œ ì˜ì¡´í•´ë„ ë¬¸ì œê°€ ì—†ë‹¤.

í‘œì¤€ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í• ë•Œë„ ì´ì™•ì´ë©´ ì¶”ìƒì ì¸ íƒ€ì…ì„ ì‚¬ìš©í•´ì•¼ í™•ì¥ì„±ì´ ì¢‹ë‹¤.

```java
ArrayList<String> list = new ArrayList<>(); ì´ê±° ëŒ€ì‹ 

List<String> list = new ArrayList<>(); ì´ê²Œ ì¢‹ë‹¤.
```

### ì»¨í…ìŠ¤íŠ¸ í™•ì¥í•˜ê¸°

í• ì¸ì„ ì œê³µí•˜ì§€ ì•ŠëŠ” ì˜í™”ì˜ ìš”ê¸ˆì„ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì„ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•œë‹¤ê³  í•˜ë©´ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

```java
public class Movie {
    private String title;
    private Duration runningTime;
    private Money fee;
    private DiscountPolicy discountPolicy;

		public Money calculateMovieFee(Screening screening, DiscountPolicy discountPolicy) {
			  if (discountPolicy == null) 
					return fee;  
	
				return fee.minus(discountPolicy.calculateDiscountAmount(screening));
    }
}
```

if (discountPolicy == null) ì´ë¼ëŠ” Movie-DiscountPolicy ì‚¬ì´ì˜ í˜‘ë ¥ê´€ê³„ì— 
ì˜ˆì™¸ ì¼€ì´ìŠ¤ê°€ ì¶”ê°€ë˜ì–´ë²„ë¦°ë‹¤.

ì´ëŸ° ì˜ˆì™¸ ì¼€ì´ìŠ¤ëŠ” Movie í´ë˜ìŠ¤ ë‚´ë¶€ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê²Œ í•˜ê³  ë²„ê·¸ í™•ë¥ ì„ ë†’ì¸ë‹¤.

í•´ê²°ë°©ë²•ìœ¼ë¡œ í• ì¸ì—†ìŒì •ì±… í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ë©´ ëœë‹¤.

```java
public class NoneDiscountPolicy extends DiscountPolicy {
    @Override
    protected Money getDiscountAmount(Screening screening) {
        return Money.ZERO;
    }
}
```

ì´ë ‡ê²Œí•˜ë©´ ê¸°ì¡´ Movie-DiscountPolicy ì‚¬ì´ì˜ í˜‘ë ¥ê´€ê³„ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ë„ ë¬¸ì œê°€ ì—†ë‹¤.

ë§Œì•½, í• ì¸ ì •ì±… ì—¬ëŸ¬ê°œë¥¼ ë™ì‹œì— ì ìš©í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ë©´ ëœë‹¤.

```java
public class OverlappedDiscountPolicy extends DiscountPolicy {
    private List<DiscountPolicy> discountPolicies = new ArrayList<>();

    public OverlappedDiscountPolicy(DiscountPolicy ... discountPolicies) {
        this. discountPolicies = Arrays.asList(discountPolicies);
    }

    @Override
    protected Money getDiscountAmount(Screening screening) {
        Money result = Money.ZERO;
        for(DiscountPolicy each : discountPolicies) {
            result = result.plus(each.calculateDiscountAmount(screening));
        }
        return result;
    }
}
```

ì´ëŸ°ì‹ìœ¼ë¡œ Movieë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  DiscountPolicyì˜ ìì‹ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ë©´

Movieê°€ ìœ ì—°í•˜ê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•´ì§„ë‹¤.

Movieê°€ ì‚¬ìš©ë  ì»¨í…ìŠ¤íŠ¸ë¥¼ í™•ì¥í•  ìˆ˜ ìˆë‹¤.

**ê²°ë¡ **: ì¶”ìƒí´ë˜ìŠ¤(DiscountPolicy)ì˜ ìì‹ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì»¨í…ìŠ¤íŠ¸ë¥¼ í™•ì¥í•  ìˆ˜ ìˆê³  ìœ ì—°í•˜ê³  ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì§„ë‹¤.

### ì¡°í•© ê°€ëŠ¥í•œ í–‰ë™

ìœ ì—°í•˜ê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ê³„ëŠ” ì‘ì§‘ë„ ë†’ì€ ì±…ì„ë“¤ì„ ê°€ì§„ ì‘ì€ ê°ì²´ë“¤ì„ ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ì—°ê²°í•¨ìœ¼ë¡œì¨ 
ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê¸°ëŠ¥ì„ ì‰½ê²Œ í™•ì¥ í•  ìˆ˜ ìˆë‹¤.

ìœ ì—°í•˜ê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì„¤ê³„ëŠ” ê°ì²´ê°€ ì–´ë–»ê²Œ(how) í•˜ëŠ”ì§€ë¥¼ ì¥í™©í•˜ê²Œ ë‚˜ì—´í•˜ì§€ ì•Šê³  
ê°ì²´ë“¤ì˜ ì¡°í•©ì„ í†µí•´ ë¬´ì—‡(what)ì„ í•˜ëŠ”ì§€ë¥¼ í‘œí˜„í•˜ëŠ” í´ë˜ìŠ¤ë“¤ë¡œ êµ¬ì„±ëœë‹¤.

ë”°ë¼ì„œ, ì½”ë“œë§Œ ë³´ê³  ê°ì²´ê°€ ì–´ë–¤ì¼ì„ í•˜ëŠ”ì§€ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.

```java
new Movie("ì•„ë°”íƒ€", 
	Duration.ofMinuites(120),
	Money.wons(1000), 
	new AmoutDiscountPolicy(  // ì •ì•¡ í• ì¸  -> ì¸ìë¡œ ìƒˆë¡œìš´ í• ì¸ì •ì±…ì„ í• ë‹¹í•  ìˆ˜ ìˆìŒ
		Money.wons(800), // 800ì›
		new SequenceCondition(1). // ì²«ë²ˆì§¸ ìƒì˜
	)
)
-> ì–´ë–¤ í–‰ë™ì„ í•˜ëŠ”ì§€ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŒ
```

**ê²°ë¡ **: 

í›Œë¥­í•œ ê°ì²´ì§€í–¥ ì„¤ê³„ë€, ê°ì²´ê°€ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ë¥¼ í‘œí˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°ì²´ë“¤ì˜ ì¡°í•©ì„ ì„ ì–¸ì ìœ¼ë¡œ í‘œí˜„í•¨ìœ¼ë¡œì¨ ê°ì²´ë“¤ì´ ë¬´ì—‡ì„ í•˜ëŠ”ì§€ë¥¼ í‘œí˜„í•˜ëŠ” ì„¤ê³„ë‹¤.

ì´ëŸ° ì„¤ê³„ë¥¼ ì°½ì¡°í•˜ëŠ” í•µì‹¬ì€ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ë‹¤.