# 12장 기본인증

### 12.1 인증

### 12.1.1 HTTP의 인증요구/인증 프레임워크

- 웹 애플리케이션이 HTTP 요청 메세지를 받으면, 서버는 요청을 처리하는 대신 사용자가 누구인지를 알 수 있게 비밀번호 같이 개인정보를 요구하는 ‘인증 요구’로 응답할 수 있음.
- 사용자가 다시 인증을 보낼때는 인증 정보를 첨부해야함.
- 인증정보가 맞지 않으면 서버는 다시 인증 요구를 보내거나 에러로 처리
- 인증정보가 맞다면 요청은 문제 없이 처리

### 12.1.2 인증 프로토콜과 헤더

HTTP에는 기본 인증과 다이제스트 인증이라는 두 가지 공식적인 인증 프로토콜이 있음

(다이제스트 인증은 13장에서..)

![Untitled](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/Untitled.png)

![Untitled](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/Untitled%201.png)

### 12.1.3 보안 영역

HTTP가 각 리소스마다 다른 접근 조건을 다루는지 설명할 필요가 있음

realm 지시자가 서술되어 있는 WWW-Authenticate 헤더는 해당 문서의 보안영역(realm)을 나누고, 보안 영역은 저마다 다른 사용자 권한을 요구함.

![Untitled](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/Untitled%202.png)

![스크린샷 2023-01-10 오전 3.31.17.png](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-01-10_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_3.31.17.png)

혹은 realm 에 “executive-committee@bigcompany.com” 같은 서버의 호스트명을 넣어 해당 리소스의 보안 영역을 알릴수있음.

### 12.2 기본인증

기본인증은 가장 잘 알려진 HTTP 인증규약임

기본인증은 원래 HTTP/1.0 에 기술되어 있었지만, HTTP 인증 상세내용을 다루는 RFC 2617 로 옮겨짐

### 12.2.1 기본인증의 예

![Untitled](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/Untitled%201.png)

| 인증요구/응답 | 헤더 문법과 설명 |
| --- | --- |
| 인증요구(서버에서 클라이언트로) | 각 사이트는 보안 영역마다 다른 비밀번호가 있을 것이다. realm은 요청 받은 문서 집합의 이름을 따옴표로 감싼 것으로, 사용자는 이 정보를 보고 어떤 비밀번호를 사용해야 하는지 알 수 있다.
WWW-Authenticate: Basic realm=따옴표로 감싼 문서 집합 정보 |
| 응답(클라이언트에서 서버로) | 사용자 이름과 비밀번호는 콜론으로 잇고, base-64로 인코딩해서 사용자 이름과 비밀번호에 쉽게 국제문자를 포함할 수 있게 하고, 네트워크 트래픽에 사용자 이름과 비밀번호가 노출되지 않게 한다.
Authorization: Basic base-64로 인코딩한 사용자 이름과 비밀번호 |

### 12.2.2 Base-64 사용자 이름/비밀번호 인코딩

 HTTP 기본 인증은 사용자 이름과 비밀번호를 콜론으로 이어서 합치고, Base-64 인코딩 메서드를 사용해 인코딩함.

![스크린샷 2023-01-10 오전 3.40.01.png](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-01-10_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_3.40.01.png)

Base-64 인코딩은 바이너리,텍스트, 국제 문자데이터 문자열을 받아 전송할 수 있게, 그 문자열을 전송가능한 문자인 알파벳으로 변환하기 위해 발명 되었음. 

전송중에 원본 문자열이 변질될 걱정 없이 원격에서 디코딩 할 수있음.
Base-64 는 어렵지 않게 사용자 이름과 비밀번호 문자를 섞을 수 있음. 

서버나 네트워크를 관리하면서 뜻하지 않게 사용자 이름과 비밀번호가 노출되는 문제를 예방하는데 도움이 됨.

### 12.2.3 프락시 인증

프락시 서버에서 접근 정책을 중앙관리 할 수 있기 때문에 프락시를 활용해도 좋음.

프락시 인증은 헤더와 상태코드만 다르고 절차는 같음.

![Untitled](12%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%20341043f41b9d45af996a866b50710627/Untitled%203.png)

### 12.3 기본 인증의 보안 결함

기본인증은 단순하고 편리하지만 안심할 수 없음.

기본인증은 악의적이지 않는 누군가가 의도치 않게 접근하는 것을 막는데 사용하거나, SSL 같은 암호 기술과 혼용됨

다음은 보안 결함임

1. 기본인증은 사용자 이름과 비밀번호를 쉽게 디코딩 할 수 있는 형식으로 네트워크에 전송함
    
    base-64 로 인코딩괸 비밀번호는 사실상 ‘비밀번호 그대로’ 보내는 것과 다름 없음
    
    외부 업자가 기본인증으로 보낸 사용자 이름과 비밀번호를 가로채는 상황이 될 수 있음.
    
    모든 HTTP 트랜잭션을 SSL 암호화채널을 통해 보내거나, 보안이 더 강화된 다이제스트 인증 같은 프로토콜을 사용하는 것이 좋음
    
2. 보안 비밀번호가 디코딩하기에 더 복잡한 방식으로 인코딩 되어 있더라하더라도
    
    기본인증은 재전송 공격을 예방하기 위한 어떤일도 하지 않음
    
3. 비밀번호를 요구하는 수많은 사이트에 지쳐버린 수많은 사용자는 그 모든 사이트에 같은 아이디와 비밀번호를 사용함. 악의를 가진 누군가가 무료인터넷 이메일 같은 사이트에서 사용자 이름과 비밀번호를 문자열 그대로 캡처하고, 동일한 사용자 이름과 비밀번호로 중요한 온라인 은행 사이트에 접근 할 수도 있음.

1. 메세지의 인증헤더를 건드리지는 않지만, 그 외 다른부분을 수정해서 트랜잭션의 본래의도를 바꿔버리는 프락시나 중개자가 개입하는 경우, 기본인증은 정상적인 동작을 보장하지 않음

1. 기본인증은 가짜 서버의 위장에 취약함. 가짜 서버나 가짜 게이트웨이에 연결되어 있는경우, 공격자는 사용자에게 비밀번호를 요청하고 그것을 나중에 사용할 목적으로 저장한 다음 에러가 난척 할 수 있음.

기본인증은 일반적은 환경에서 개인화나 접근을 제어하는데 편리함, 다른사람들이 보지 않기를 원하지 않지만, 보더라도 치명적이지 않은 경우 여전히 유용함.

기본인증은 호기심 많은 사용자가 우연이나 사고로 정보에 접근해서 보는 것을 예방하는데 사용함.

기본인증은 사용자 이름과 비밀번호를 악의적인 개인들에게 숨기려고 암호화된 전송(SSL 같은)과 함께 연계해서 사용할 수 있음.