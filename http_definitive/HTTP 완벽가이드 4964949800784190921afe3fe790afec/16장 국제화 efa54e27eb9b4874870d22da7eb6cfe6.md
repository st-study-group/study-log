# 16장 국제화

배울 내용

- HTTP 가 어떻게 여러 언어 문자들의 체계 및 표준과 상호작용하는지 설명함
- HTTP 프로그래머가 올바르게 업무를 수행하는데 도움될 수 있도록 전문용어, 기술, 표준의 간략한 개요를 제공함
- 언어를 위한 표준 명명 체계와, 어떻게 표준화된 언어 태그가 선택한 컨텐츠를 서술하는지에 대해 설명함
- 국제화된 URI의 규칙과 주의사항을 개괄적으로 서술함
- 날짜와 그 외 다른 국제화 이슈에 대해 간단히 논의함

### 16.1 국제적인 콘텐츠를 다루기 위해 필요한 HTTP 지원

HTTP 에서 엔터티 본문이란 그저 비트들로 가득 찬 상자에 불과함

서버는 문서의 문자와 언어를 HTTP Content-Type charset 매개 변수와 Content-Language 헤더를 통해 알려줌

클라이언트는 무엇을 선호하는지 말해주기 위해 Accept-Charset 과 Accept-Language 헤더를 보냄

```json
Accept-Language: fr, en;q=0,8
Accept-Charset: ios-8859-1, utf-8
```

(q 품질인자)

### 16.2 문자집합과 HTTP

### 16.2.1 차셋(Charset)은 글자를 비트로 변환하는 인코딩이다

차셋 태그는 등록된 MIME 문자집합에 표준화 되어 있고, IANA가 관리함.(부록 H 에 다수 포함.. 많이 있음..)

charset 매개변수는 수신자에게 콘텐츠 비트들을 글자로 디코딩 하기위해 알려주는것임

```json
Content-Type: text/html; charset=iso-8859-6
```

### 16.2.2 문자집합과 인코딩은 어떻게 동작하는가

- a) 문서를 이루는 비트들은 특정 문자 코드로 변환됨
- b) 특정 문자 코드는 코딩된 문자집합의 특정 요소를 선택하기 위해 사용됨
    - ex) 255 의 문자코드는 ‘ARABIC LETTER FEH’ 에 해당됨
    - a와 b에 사용되는 알고리즘은 MIME 차셋 태그를 통해 결정됨
- c) 글자 모양을 어떻게 표현할 것인가 하는것은 사용자의 그래픽 디스플레이 소프트웨어가 결정함
    - 브라우저, 운영체제, 글꼴

![스크린샷 2023-01-26 오전 12.44.40.png](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-01-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_12.44.40.png)

### 16.2.3 잘못된 차셋은 잘못된 글자들을 낳는다

클라이언트가 잘못된 charset 매개변수를 사용한다면, 클라이언트는 이상한 깨진 글자를 보게됨

### 16.2.4 표준화된 MIME 차셋 값

 HTTP 는 표준화된 MIME 차셋 태그를 Content-Type 과 Accept-Charset 헤더에 사용함.

### 16.2.5 Content-Type charset 헤더와 META 태그

```json
Content-Type: text/html; charset=iso-2022-jp
```

웹 서버는 클라이언트에게 MIME 차셋 태그를 charset 매개변스와 함께 Content-Type 헤더에 담아 보냄

만약 문자집합이 명시적으로 나열되지 않았다면, 수신자는 문서의 콘텐츠로부터 문자집합을 추측하려 시도함

ex) `<META HTTP-EQUIV="Content-Type">` 태그에서 찾을 수 있음

```html
<HEAD>
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-2022-jp">
	<META LANG="jp">
	<TITLE>A Japanese Document</TITLE>
</HEAD>
<BODY>
...
```

### 16.2.6 Accept-Charset 헤더

HTTP 클라이언트는 서버에게 Accpet-Charset 요청 헤더를 통해 클라이언트가 지원하는 문자 인코딩 목록을 제공함.

문자 인코딩 구조중 어떤것으로 콘텐츠를 반환할지는 서버의 자유임

Accept-Charset 요청헤더에 대응하는 Content-Charset 응답헤드는 존재하지 않는 다는것에 주의해야함.

MIME 과의 호환을 위해 Content-Type 응답헤더의 charset 매개변수를 통해 서버로 부터 돌려받음

### 16.3 다중언어 문자 인코딩에 대한 지침

### 16.3.1 문자집합 용어

- 문자
    - 알파벳 글자, 숫자, 구두점, 표의문자(중국어에서와 같은), 기호, 유니코드
    - 여러 언어의 여러글자에게 알맞고 유일한 이름
- 글리프
    - 하나의 글자를 표현하기 위한, 획의 패턴이나 다른것과 구분되는 유일한 시각적 형태
    - 하나의 글자를 여러 방식으로 쓰는것이 가능하다면 글리프를 여러개 가질 수 있음
- 코딩된 문자
    - 우리가 글자를 다룰수 있도록 각 글자에 할당된 유일한 숫자
- 코드 공간
    - 문자 코드값으로 사용하려고 계획해 둔 정수의 범위
- 코드 너비
    - 각 문자 코드의 (고정된 크기의) 비트 개수
- 사용 가능한 문자 집합
    - 글자들에 대한 특정한 작업 집합(세상에 존재하는 모든 글자의 부분 집합)
- 코딩된 문자 집합
    - 사용 가능한 문자 집합을 받아서 각 글자에 코드 공간의 코드를 할당 해주는 코딩된 문자들의 집합
- 문자 인코딩 구조
    - 숫자로 된 문자 코드들을 콘텐츠 비트의 연속으로 인코딩하는 알고리즘

### 16.3.2 ‘차셋(Charset)’은 형편없는 이름이다

엄밀히 말해 MIME 차셋 태그(Content-Type charset 매개변수와 Accept-Charset 헤더에서 쓰이는)는 문자 집합을 의미하는 것은 결코 아님

MIME 차셋 값은 데이터 비트를 고유한 문자의 코드로 매핑하는 알고리즘의 이름임.

이것은 문자 인코딩 구조와 코딩된 문자집합의 개념을 합침 것임.

이미 문자 인코딩 구조와 코딩된 문자집합에 대한 표준이 존재하기 때문에 사용중임

### 16.3.3 문자

같은 글자라도 그 글자가 단어에서 어디에 위치하느냐에 따라 각각 다른 모양을 갖는 표기 체계도 많음

![Untitled](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/Untitled.png)

### 16.3.4 글리프(glyphs), 연자(ligatures) 그리고 표현 형태

글리프는 각 글자를 그리는 특정한 방법임

각 문자는 미적인 양식과 스크립트에 따라 여러가지 글리프를 가짐

많은 필기체와 활자체가 인접한 글자들이 부드럽게 이어지는 연자(ligature)를 지원함

![Untitled](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/Untitled%201.png)

일반적인 규칙은, 글리프 하나를 다른 것으로 바꾸었을때 텍스트 의미가 비뀐다면 두 글리프는 서로 다른 글자임

아니라면 그것들은 모양만 다를뿐 같은 글자임

### 16.3.5 코딩된 문자 집합(Coded Charset)

코딩된 문자집합은 보통 코드 번호로 인덱싱된 배열로 구성됨

![Untitled](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/Untitled%202.png)

### 16.3.6 문자 인코딩 구조

문자 인코딩구조 들은 크게 세 종류로 분류 할 수 있음

- 고정폭
    - 고정폭 인코딩은 각 코딩된 문자를 고정된 길이의 비트로 표현함.
    - 빠르게 처리될 수 있지만 공간을 낭비할 우려가 있음
- 가변폭(비모달)
    - 다른 문자 코드 번호에 다른 길이의 비트를 사용함
    - 글자의 비트 길이를 줄일 수 있음, 국제 문자에 대해서는 여러 바이트를 사용함으로써 이전의 8비트 문자 집합과의 호환성 유지 할 수 있음
- 가변폭(모달)
    - 모달 인코딩은 다른 모드로 전환을 위해 특별한 ‘escape’ 패턴을 사용함
        - 모달 인코딩은 처리하기에 복잡하지만 복잡한 표기 체계를 효과적으로 지원해 줄 수 있음

몇가지 인코딩 구조

- 8비트
    - 8비트 고정폭
    - 256개 문자 코드 범위에 대한 문자 집합만 지원함
    - iso-8859 문자 집합군은 8비트 아이덴티티 인코딩을 사용함
- UTF-8
    - USC Transformation Format 의 약자임
    - UTF-8은 문자 코드의 값을 위해 비모달 가변길이 인코딩을 사용함
    - 첫 바이트의 선두 비트들은 인코딩된 문자의 길이를 바이트 단위로 나타냄, 그 이후 바이트 들은 각 6비트의 코드값을 담음
    
    ![스크린샷 2023-01-26 오전 3.08.45.png](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-01-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_3.08.45.png)
    

ex) ‘Z’ (90) ⇒ **1011010** (이진수) (7비트)

   ⇒ 0**1011010**

5073 ⇒ **1001111010001** (이진수) (13 비트)

  ⇒ 1110cccc 10cccccc 10cccccc

  ⇒  1110000**1** 10**001111** 10**010001**

- euc-kr
    - KS X 1003 과 KS X 1001 두 가지 문자 집합을 지원함
        - KS X 1001 이 담고 있는 한글은 총 2,350 자로 한글을 모두 표현하기 턱없이 부족함
        - KS X 1001 은 한글 채움 문자를 이용해 한글을 표현함
            - (채움) 초성 중성 종성
                - 똠 ⇒ (채움) ㄸㅗㅁ
                - (채움) == 0xA4 0xD4

### 16.4 언어 태그와 HTTP

언어 태그는 언어에 이름을 붙이기 위한 짧고 표준화된 문자열임

우리는 표준화된 이름이 필요함(각 언어를 서로 다르게 부를 수 있기 때문)

많은 다른 언어에 대한 언어 태그가 존재함.

### 16.4.1 Content-Language 헤더

Content-Language 헤더는 텍스트 문서만을 위한것은 아님

오디오 클립, 동영상, 그리고 애플리케이션도 특정언어 사용자를 대상으로 할 수 있음.

만약 컨텐츠가 여러 언어 사용자를 대상으로 하고 있다면, 여러 언어를 나열할 수 있음

```html
Content-Language: mi, en
```

여러 언어가 하나의 엔터디에 동시에 사용되었더라고 해서, 반드시 여러 언어 사용자들을 대상으로 하고 있음을 의미 하는것은 아님

### 16.4.2 Accept-Language 헤더

클라이언트는 자신이 이해할 수 있는 콘텐츠를 요청하기 위해 Accept-Language와 Accept-Charset 을 사용 할 수있음

### 16.4.3 언어 태그와 종류

언어 태그는 RFC 3066 로 문서화된 표준화된 문법을 갖고 있음

태그는 다음을 표현하기 위해 사용 될 수 있음

- 일반적인 언어의 종류
- 특정 국가의 연어
- 방언
- 지방어
- 그 외의, 다른 언어의 변형이 아닌 표준 언어
- 비표준 언어

### 16.4.4 서브태그

언어 태그는 하이픈으로 분리된 하나 이상의 서브태그로 이루어저 있음

- 주 서브 태그는 오직 A-Z 까지의 글자만 포함
- 다음 서브 태그는 알파벨이나 숫자를 표함할 수 있으며 최대 8글자 까지 가능함

![스크린샷 2023-01-26 오전 3.39.49.png](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-01-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_3.39.49.png)

### 16.4.5 대소문자의 구분 및 표현

모든 태그는 대소문자가 구분되지 않음

태그 en 과 eN은 같음

관용적으로 언어는 소문자, 국가는 대문자임

### 16.4.6 IANA 언어 태그 등록

첫번째와 두번째 언어 서브 태그의 값은 표준 문서와 관리하는 조직에서 정의됨

언어 태그가 표준 국가와 언어값의 조합이라면, 그 태그는 굳이 등록되지 않아도 무방함

오직 표준 국가와 언어 값으로 구성 될 수 없는 언어 태그들만 특별히 IANA 에 등록 될 필요가 있음

### 16.4.7 첫번째 서브 태그: 이름공간

첫번째 서브태그는 보통 ISO 639 표준 언어 집합에서 선택된 표준화된 언어 토큰 이라고함

규칙이 있음

- 두 글자라면 Iso 639, 639-1 표준의 언어 코드 임
- 세글자라면 iso 639-2 표준과 확장에 열거된 언어임
- 글자 ‘i’ (ex) i-abcd), 이 언어 태그는 틀림없이 IANA 에 등록된 것임
- 글자 ‘x’ 라면 이 언어 태그는 특정 개인이나 집단 전용의 비표준 확장 서브태그임

### 16.4.8 두번째 서브 태그: 이름 공간

두번째 서브태그는 보통 Iso 3166 국가 코드와 지역 표준 집합에서 선택된 표준화 된 국가 토큰 임

규칙이 있음

- 두글자라면 iso 3166에 정의된 국가/지역 임
- 3~8 글자라면 IANA 에 등록된 것임
- 한글자라면 뭔가 잘못된것임

### 16.4.9 나머지 서브태그: 이름 공간

세번째 와 그 이후의 서브태그에 대해서는 8자 이하의 알파벳과 숫자로 이루어져 있어야 하는 규칙만 존재함

### 16.4.10 선호 언어 설정하기

웹브라우저 설정에 선호 언어 설정할 수 있음

### 16.5 국제화된 URI

오늘날 URI 는 국제화를 그다지 지원하지 않음

호스트명과 URL 경로에 더 풍부한 문자집합을 포함할 수 있도록 노력중이지만

이러한 표준은 널리 받아들여지지도 사용되고 있지도 않음

### 16.5.1 국제적 가독성 vs 의미있는 문자들

URI 설계자들은 이메일,전화, 광고판, 심지어 라디오를 통해 다른 이들과 공유할 수 있기를 원했음

URI 가 사용하기 쉽고 기억하기 쉽길 바랬음

두가지 목표가 충돌하였음

URI 에 들어가고 조작하고 공유하기 쉽게 하기위해 매우 제한된 공통 문자집합을 선택함 (알파벳, 숫자, 몇개의 특수문자)

불행히도 문자집합에는 제한이 있기에, URI는 비영어권 사람들도 쉽게 사용하고 기업할 수 있도록 그들의 문자로 만들 수 있게 설계되지는 못했음

URI 저자들은 리소스 식별자의 가독성과 공유 가능성의 보장이 대부분의 의미있는 문자들로 구성될 수 있도록 하는것보다 더 중요하다고 여겼음

그래서 오늘날 ASCII 문자들의 제한된 집합으로 이루어진 URI 를 갖게 됨

### 16.5.2 URI 에서 사용될 수 있는 문자들

- 예약 되지 않은 문자들
    - [A-Za-z0-9] | "-" | "_" | "." | "!" | "~" | "*" | "'" | """ | "(" | ")"
- 예약 된 문자들 (특별한 의미 가짐)
    - ";" | "/" | "?" | ":" |"@" | "&" | "=" | "+" | "$" | ","
- 이스케이프 문자들
    - "%" `<HEX>` `<HEX>`

### 16.5.3 이스케이핑과 역이스케이핑

URI 이스케이프는 예약된 문자나 다른 지원하지 않는 글자들을 안전하게 URI 에 삽입할 수 있는 방법을 제공함

% 하나와 뒤이은 16진수 둘로 이루어진 세글자의 문자열임

%20 ⇒ 32 의 16진법 표현임

퍼센트를 하고 싶다면 (25가 퍼센트 기호의 아스키 코드) %25 라고 입력하면 됨 

![스크린샷 2023-01-26 오전 4.06.51.png](16%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%80%E1%85%AE%E1%86%A8%E1%84%8C%E1%85%A6%E1%84%92%E1%85%AA%20efa54e27eb9b4874870d22da7eb6cfe6/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-01-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_4.06.51.png)

### 16.5.4 국제 문자들을 이스케이핑하기

이스케이프 값들은 ASCII 코드의 범위 (0-127) 에 있어야함

### 16.5.5 URI 에서의 모달 전환

URI 는 다른 문자집합의 글자를 표현하기 위해 ASCII 문자열을 사용함

현재 URI 는 그다지 국제화에 친화적이지 않음.

---

### 16.6.3 도메인 이름

대부분의 웹브라우저가 퓨니(punycode)코드를 이용해 국제화 도메인이름을 지원함

퓨니코드란 유니코드 문자열을 호스트명에서 사용 가능한 문자로만으로 이루어진 문자열로 변환하는  방법임(RFC 3492로 정의되어 있음)

웹브라우저들은 이 기법을 이용해 사용자가 입력한 다국어로 된 도메인 이름을 알파벳과 숫자로 된 도메인 이름으로 변환함

ex) [한글.com](http://한글.com) ≤=≥ xn—bj0bj06e.com